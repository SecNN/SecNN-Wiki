# Out Of Authority

## 0x01 漏洞描述

越权漏洞是指应用程序未对当前用户操作的身份权限进行严格校验，导致用户可以操作超出自己管理权限范围的功能，从而操作一些非该用户可以操作的行为。

## 0x02 常见应用场景

越权漏洞一般可以分为：垂直越权，水平越权两种

- **水平越权**

  攻击者可以访问与他拥有相同权限的用户的资源，资源权限ID不变，资源归属ID改变；

- **垂直越权**

  低级别攻击者可以访问高级别权限用户的资源，资源权限ID不变，资源归属ID改变；

  低级别攻击者可以访问高级别权限用户的资源，资源权限ID改变，资源归属ID不变；

## 0x03 漏洞危害

* 垂直越权漏洞会导致低权限用户用来执行高权限用户的功能，获取高权限用户的账号信息，执行高权限用户的操作功能。
* 水平越权会导致同一层级间的用户可以互相访问到对方的敏感信息，如姓名、手机号、联系地址、个人资料、订单记录等。同时还可能会以其他平级权限用户的身份来执行某行功能，如删除，添加，修改等。

## 0x04 修复建议

* 设计表时对用户ID、订单ID等根据ID进行操作的ID字段进行随机化、比如加入时间戳的md5值`md5($datetime.$id)`。
* 严格校验当前用户操作与当前登录用户身份权限是否匹配。